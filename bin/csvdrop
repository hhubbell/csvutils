#!/usr/bin/env python
#
# Remove the specified columns from an input csv and return the 
# result to stdout.
#

import csvutils as cu
import sys


if __name__ == '__main__':
    parser = cu.default_arguments()
    parser.add_argument('cols',
        nargs='+')

    args = parser.parse_args()

    outfile = sys.stdout
    delim = args.delim.decode('string-escape')

    header, rows = cu.read(args.infile, delimiter=delim)
    drops = cu.indexes(header, args.cols)

    mheader = cu.imask(header, drops)
    mrows = [cu.imask(x, drops) for x in rows]

    cu.write(outfile, mheader, mrows)
